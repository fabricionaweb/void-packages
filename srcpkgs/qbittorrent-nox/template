# Template file for 'qbittorrent-nox'
pkgname=qbittorrent-nox
version=4.5.4
revision=2
create_wrksrc=yes
build_wrksrc="qbittorrent-${version}"
build_style=gnu-configure
build_helper=qmake
configure_args="--disable-systemd --with-boost=${XBPS_CROSS_BASE}/usr
 --with-boost-libdir=${XBPS_CROSS_BASE}/usr/lib"
hostmakedepends="automake libtool pkg-config qt5-host-tools qt5-qmake qt5-tools"
makedepends="libtorrent-rasterbar-devel qt5-declarative-devel"
depends="qt5-plugin-sqlite"
short_desc="Free software alternative to µtorrent - no X11"
maintainer="Érico Nogueira <ericonr@disroot.org>"
license="GPL-2.0-or-later"
homepage="https://www.qbittorrent.org/"
changelog="https://www.qbittorrent.org/news.php"
distfiles="${SOURCEFORGE_SITE}/qbittorrent/qbittorrent-${version}.tar.xz"
checksum=f92bcd3ed25600796c59257c507e56a252a65af60bd042b71f1e7ff3fe5264da
CXXFLAGS=-std=gnu++17

do_configure() {
  cd ${wrksrc}/${build_wrksrc}
  ./bootstrap.sh
  QT_QMAKE=${XBPS_WRAPPERDIR} ./configure ${configure_args} --disable-gui --enable-webui
}

do_build() {
  make ${makejobs} CC="$CC" CXX="$CXX" LINK="$CXX"
}

do_install() {
  make ${makejobs} INSTALL_ROOT=${DESTDIR} install
}
